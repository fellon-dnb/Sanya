package com.sanya.client.core.api;

/**
 * Интерфейс криптографического движка.
 * Определяет общий контракт для модулей, выполняющих шифрование и расшифровку данных.
 *
 * Назначение:
 *  - Абстрагировать криптографическую реализацию (AES-GCM, ChaCha20, X25519 и т.д.)
 *  - Упростить тестирование и возможность подмены реализации (например, на mock или аппаратное шифрование)
 *  - Централизовать логику E2EE в клиенте
 *
 * Использование:
 *  Реализация может использовать KeyDirectory и Encryptor для симметричных и асимметричных операций.
 */
public interface CryptoEngine {

    /**
     * Шифрует данные для указанного получателя.
     *
     * @param data      исходные байты
     * @param recipient идентификатор получателя (например, имя пользователя)
     * @return зашифрованные байты
     */
    byte[] encrypt(byte[] data, String recipient);

    /**
     * Расшифровывает данные, полученные от отправителя.
     *
     * @param data   зашифрованные байты
     * @param sender идентификатор отправителя
     * @return расшифрованные байты
     */
    byte[] decrypt(byte[] data, String sender);
}
